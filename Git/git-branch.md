

# Git branch

> 협업!

## 브랜치(Branch)

- 독립적으로 어떤 작업을 진행하기 위한 개념.
- 여러 작업을 동시에 진행할 수 있게 해준다.

- 장점
  - 작업 단위로 작업 기록을 남기게 되므로 문제 발생 시 원인을 찾거나 대책을 마련하는 게 쉬워짐

### master 브랜치

- 저장소를 처음 만들었을 때 생기는 브랜치
- 저장소에 새로운 내용을 저장(Commit)하면 모두 master 브랜치에서 처리할 수 있게됨.



### 브랜치의 이해

1. branch는 단순한 포인터다.
2. master branch는 기본으로 제공되는 포인터 이름이다.
3. HEAD는 "현재 작업하고 있는" commit의 포인터다. (포인터의 포인터인 경우가 많음)
   - 현재 내가 작업 중인 커밋을 의미한다.
   - HEAD -> master == 현재 master에서 작업중



### 통합 브랜치

- 언제든지 배포할 수 있는 버전을 만들 수 있어야하는 브랜치, 완성되어있는 버전, 안정적인 상태 유지.
- 어플리케이션의 모든 기능을 정상적으로 동작할 수 있는 상태가 저장되어있어야함.

- 보통 master 브랜치를 통합 브랜치로 사용.

### 토픽 브랜치

- 기능 추가나 버그 수정같은 단위 작업을 위한 브랜치
- 여러 작업을 동시에 진행할 때, 그 수만큼 토픽 브랜치를 생성해서 작업 가능

- 결국 통합 브랜치에 병합되기 위해 존재

<br>

## 브랜치 사용법

### 브랜치 생성

- `$ git branch <branch-name>`
- 현재 HEAD가 가리키고 있는 커밋에서 브랜치를 생성함

### 브랜치 전환

- `$ git switch <branch-name>`

- HEAD를 해당 branch로 옮김.

- 새로운 브랜치 생성과 동시에 전환

  `$ git switch -c b3`

### 브랜치 목록 확인

- `$ git branch`

### 브랜치 병합

- `$ git merge <branch-name>`

- 다른 브랜치를 흡수하려는 더 큰 브랜치에서 작업해야함.

- Fast-Forward
  - 다른 브랜치의 내용을 가져오기만 하면 되는 경우
  - 병합 시 새로운 커밋이 생기는게 아니라 master 포인터를 해당 브랜치의 커밋으로 이동.
  - 빨리감기
  - 다른 브랜치의 기록을 따라감.
- Auto Merge
  - 병합 시 새로운 커밋을 만들어 두 브랜치의 작업 내용을 모두 가져와 합침.
  - log 를 확인해보면 `Merge branch '<branch-name>'` 로 새로운 커밋을 확인할 수 있음
  - 새로운 커밋에는 작업 중이던 브랜치가 이동함.
- Manual Merge (CONFLICT)
  - 파일 변경 내용에서 충돌이 일어나는 경우
  - 충돌이 난 파일에 ! 표시, 비교를 위해 낙서도 해줌.
  - VS Code에서는 Accept Current Change, Accept Incoming Change 버튼 등도 제공해줌.
  - 충돌 파일 수정 후 다시 add, commit 진행해야함

<br>

## Remote 저장소에서 협업을 하는 경우

- Remote 저장소의 master가 통합 브랜치
- 각 팀원들은 각자의 local에 clone을 받아온다.
- 각 팀원들은 각자의 저장소에서 브랜치를 만들어 작업한다.
- remote 저장소의 브랜치에 push한다.
- remote 저장소에서 merge request & merge 한다.
- 각 팀원들은 remote 저장소의 master를 local 저장소에 master에 pull 받아온다.
- local에서 작업했던 브랜치 삭제해도 된다.
- 새로 작업을 할 브랜치를 만들어 작업한다.